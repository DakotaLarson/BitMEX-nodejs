"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const app_root_path_1 = require("app-root-path");
const request_1 = __importDefault(require("request"));
const SwaggerParser_1 = require("./SwaggerParser");
const TSWriter_1 = require("./TSWriter");
const SWAGGER = 'https://www.bitmex.com/api/explorer/swagger.json';
const outputClass = app_root_path_1.path + '/src/api/BitmexAPI.ts';
const outputInterfaces = app_root_path_1.path + '/src/common/BitmexInterfaces.ts';
const HEADER = `
    /** THIS FILE IS AUTOMATICALLY GENERATED FROM : ${SWAGGER} **/

    // tslint:disable:max-line-length`;
request_1.default.get(SWAGGER, async (err, _res, body) => {
    // tslint:disable-next-line:no-console
    if (err) {
        return console.log(err);
    }
    const data = JSON.parse(body);
    const swagger = new SwaggerParser_1.SwaggerParser(data);
    await TSWriter_1.TSWriter(outputInterfaces, `
    ${HEADER}
    ${swagger.createInterfaces()}
    `);
    await TSWriter_1.TSWriter(outputClass, `
    ${HEADER}
    import { BitmexAbstractAPI } from './BitmexAbstractAPI';
    import * as ${SwaggerParser_1.CONTAINER} from '../common/BitmexInterfaces';
    export class BitmexAPI extends BitmexAbstractAPI {
    ${swagger.createClass()}
    }`);
});
